<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="pics from twitter search results for #bachpan.">
<meta name="keywords" content="twitter,bachpan">
<title>#bachpan</title>
<style>
*{margin:0;padding:0;border:0;}
body{font-size:12px;font-family:sans-serif;background-color:#222;color:#fefefe;margin:0px;padding:0px;}
h1{text-align:left;font-size:1.5em;width:450px;float:left;margin:0px;padding:0px;line-height:1.5em;}
h1 a{color:#1FC4FF;}
a{text-decoration:none;}
header{display:block;margin:0px;padding:10px;overflow:hidden;background:#111;}
#container{width:100%;overflow:hidden;margin:0 auto 20px;}
#dplist{list-style-type:none;}
#dplist li{float:left;width:48px;height:48px;}
img.loading{width:48px;height:48px;}
.pic img{width:48px;height:48px;}
#error-notification{display:none;position:fixed;width:100%;text-align:center;line-height:1.3em;color:#EEE;letter-spacing:0.1em;}
</style>
<!--[if IE]><script>var e="abbr,article,aside,audio,canvas,datalist,details,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(',');var i=e.length;while(i--){document.createElement(e[i]);}</script><![endif]-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
<script>
function notify_error(XMLHttpRequest, textStatus, errorThrown){
    $("#error-notification").text("Something went wrong while contacting twitter."+ textStatus).show();
}
var query = "?page=1&rpp=100&q=bachpan";
var dplist = [];
function load_tweets(){

	function render_tweets(data){
        query = data.next_page;
        $.each(data.results, function(){
            if( !(this.from_user in dplist) ){
                dplist[this.from_user] = this.profile_image_url;
                var pic = $("<a></a>").attr({'target':'twitteruser', 'href': 'http://twitter.com/'+this.from_user, 'title': this.from_user}).addClass('pic');
                pic.html("<img src='"+this.profile_image_url+"' alt='"+this.from_user+"'>");
                var li = $("<li></li>").append(pic);
                $("#dplist").prepend(li);
            }
        });
        $("#error-notification").hide();
        $(".loading","#dplist").remove();
    }

    var li = $("<li></li>").html("<img width='48' height='48' alt='loading' src='ajax-loader.gif' />").addClass('loading');
    $("#dplist").append(li);
	$.ajax({
        url: 'http://search.twitter.com/search.json'+query+'&show_user=true&result_type=recent&callback=?',
        dataType: 'jsonp',
        success: render_tweets,
        type: "GET",
        error: notify_error,
        timeout: 1000*20
        });

}


$(function(){
load_tweets();
setInterval(load_tweets, 1000*10);

});
</script>
</head>
<body>
<p id="error-notification"></p>
<header>
	<h1><a href="">#bachpan</a></h1>
</header>
<div id="container">
<ul id="dplist"></ul>
</div>

</body>
</html>
